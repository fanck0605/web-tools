"use strict";(self.webpackChunkant_design_pro=self.webpackChunkant_design_pro||[]).push([[271],{37531:function(se,E,a){a.r(E),a.d(E,{default:function(){return le}});var P=a(70004),k=a(30279),p=a.n(k),V=a(46686),U=a.n(V),b=a(81463),$=a(38142),s=a(88106),N=a(37300),j=a(82711),L=a(57150),w=a(57836),T=a(28047),m=a(59496),G=a(35290),C=a.n(G),H=a(411),A=a.n(H),Z={clash:"Clash",clashr:"ClashR",quan:"Quantumult",quanx:"QuantumultX",loon:"Loon",ss:"SS (SIP002)",sssub:"SS Android",ssd:"SSD",ssr:"SSR",surfboard:"Surfboard","surge&ver=2":"Surge2","surge&ver=3":"Surge3","surge&ver=4":"Surge4",v2ray:"V2Ray"},R=function(){var r=location.pathname;return r.endsWith("/")?r.substring(0,r.length-1):r},Q=function(){var i=A()(C()().mark(function r(){var u;return C()().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("".concat(R(),"/rule-list.json"));case 2:return u=e.sent,e.next=5,u.json();case 5:return e.abrupt("return",e.sent);case 6:case"end":return e.stop()}},r)}));return function(){return i.apply(this,arguments)}}(),X=function(){var i=A()(C()().mark(function r(){var u;return C()().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("".concat(R(),"/backend-list.json"));case 2:return u=e.sent,e.next=5,u.json();case 5:return e.abrupt("return",e.sent);case 6:case"end":return e.stop()}},r)}));return function(){return i.apply(this,arguments)}}(),z=function(){var r=(0,m.useState)([]),u=U()(r,2),t=u[0],e=u[1];return(0,m.useEffect)(function(){var l=!1,o=[{value:window.location.origin+"/sub"}];return e(o),X().then(function(d){l||e(o.concat(d))}),function(){l=!0}},[]),t},M=z,W=function(){var r=(0,m.useState)([]),u=U()(r,2),t=u[0],e=u[1];return(0,m.useEffect)(function(){var l=!1;return Q().then(function(o){l||e(o)}),function(){l=!0}},[]),t},J=W,K=function(r){var u=r.get("target");if(!u)return null;if(!Z.hasOwnProperty(u)){var t=r.get("ver");if(!t||(u="".concat(u,"&ver=").concat(t),!Z.hasOwnProperty(u)))return null}return u},Y=function(r){var u=r.backendUrl,t=r.targetType,e=r.sourceUrls,l=r.ruleUrl,o=r.filename,d=r.enableUdp,c=r.exclude,v=encodeURIComponent(e.split(/[\n|]/).map(function(S){return S.trim()}).filter(function(S){return S}).join("|")),F=encodeURIComponent(l),f="".concat(u,"?target=").concat(t,"&url=").concat(v,"&config=").concat(F);return o&&(f+="&filename=".concat(o)),c&&(f+="&exclude=".concat(encodeURIComponent(c))),d&&(f+="&udp=".concat(d)),f},q=function(r){var u,t=new URL(r),e=t.searchParams,l={backendUrl:"".concat(t.origin).concat(t.pathname)},o=K(e);o&&(l.targetType=o);var d=(u=e.get("url"))===null||u===void 0?void 0:u.replaceAll("|",`
`);d&&(l.sourceUrls=d);var c=e.get("config");c&&(l.ruleUrl=c);var v=e.get("filename");v&&(l.filename=v);var F=e.get("exclude");F&&(l.exclude=F);var f=e.get("udp");return(f==="true"||f==="false")&&(l.enableUdp=f),l},_=a(60042),y={tailButtonContainer:"tailButtonContainer___ZcOHp",tailButton:"tailButton___XHdRn"},n=a(4637),I={labelCol:{xs:{span:5},sm:{span:5},md:{span:4}},wrapperCol:{xs:{span:17},sm:{span:17},md:{span:18}}},ee={wrapperCol:{span:24}},O=function(r,u){return u?u.label?u.label.toUpperCase().includes(r.toUpperCase()):u.value.includes(r):!1},re=function(r,u){var t=U()(r,2),e=t[0],l=t[1];return(0,n.jsx)(b.Z.Option,{value:e,children:l},u)},ne=function(){$.ZP.warning("\u656C\u8BF7\u671F\u5F85")},ue=function(r){console.debug("Subconverter render");var u=s.Z.useForm(),t=U()(u,1),e=t[0],l=s.Z.useForm(),o=U()(l,1),d=o[0],c=M(),v=J();(0,m.useEffect)(function(){c[0]&&!e.getFieldValue("backendUrl")&&e.setFieldsValue({backendUrl:c[0].value})},[e,c]),(0,m.useEffect)(function(){v[0]&&!e.getFieldValue("ruleUrl")&&e.setFieldsValue({ruleUrl:v[0].value})},[e,v]);var F=(0,m.useMemo)(function(){var h,g,x={targetType:"clash"},B=(h=c[0])===null||h===void 0?void 0:h.value;B&&(x.backendUrl=B);var D=(g=v[0])===null||g===void 0?void 0:g.value;return D&&(x.ruleUrl=D),x},[c,v]),f=(0,m.useCallback)(function(){e.validateFields().then(function(h){var g=Y(h);d.setFieldsValue({subscriptionUrl:g})}).catch(function(){return console.error("\u8BA2\u9605\u94FE\u63A5\u751F\u6210\u9519\u8BEF\uFF01")})},[e,d]),S=(0,m.useCallback)(function(h){var g=h.target.value;try{var x=q(g);e.setFieldsValue(x)}catch{console.error("\u9519\u8BEF\u7684\u8BA2\u9605\u94FE\u63A5\uFF01")}},[e]);return(0,n.jsxs)(N.Z,p()(p()({},r),{},{title:"Subscription Converter",children:[(0,n.jsxs)(s.Z,p()(p()({},I),{},{form:e,initialValues:F,children:[(0,n.jsx)(s.Z.Item,{label:"\u8BA2\u9605\u94FE\u63A5",name:"sourceUrls",rules:[{required:!0,message:"\u8BA2\u9605\u94FE\u63A5\u4E0D\u53EF\u4E3A\u7A7A"}],children:(0,n.jsx)(j.Z.TextArea,{placeholder:"\u8BF7\u8F93\u5165\u8BA2\u9605\u94FE\u63A5\u5730\u5740",rows:3,allowClear:!0})}),(0,n.jsx)(s.Z.Item,{label:"\u76EE\u6807\u7C7B\u578B",name:"targetType",rules:[{required:!0,message:"\u76EE\u6807\u7C7B\u578B\u4E0D\u53EF\u4E3A\u7A7A"}],children:(0,n.jsx)(b.Z,{children:Object.entries(Z).map(re)})}),(0,n.jsx)(s.Z.Item,{label:"\u540E\u7AEF\u5730\u5740",name:"backendUrl",rules:[{required:!0,message:"\u540E\u7AEF\u5730\u5740\u4E0D\u53EF\u4E3A\u7A7A"}],children:(0,n.jsx)(L.Z,{placeholder:"\u8BF7\u8F93\u5165\u540E\u7AEF\u670D\u52A1\u5668\u5730\u5740",options:c,allowClear:!0,filterOption:O})}),(0,n.jsx)(s.Z.Item,{label:"\u89C4\u5219\u5730\u5740",name:"ruleUrl",rules:[{required:!0,message:"\u89C4\u5219\u5730\u5740\u4E0D\u53EF\u4E3A\u7A7A"}],children:(0,n.jsx)(L.Z,{placeholder:"\u8BF7\u8F93\u5165\u8FDC\u7A0B\u89C4\u5219\u5730\u5740",options:v,allowClear:!0,filterOption:O})}),(0,n.jsx)(s.Z.Item,{label:"\u6587\u4EF6\u540D\u79F0",name:"filename",children:(0,n.jsx)(j.Z,{placeholder:"\u8BF7\u8F93\u5165\u6587\u4EF6\u540D\u79F0",allowClear:!0})}),(0,n.jsx)(s.Z.Item,{label:"\u6392\u9664\u8282\u70B9",name:"exclude",children:(0,n.jsx)(j.Z,{placeholder:"\u8BF7\u8F93\u5165\u6392\u9664\u8282\u70B9\u5173\u952E\u5B57\uFF0C\u652F\u6301\u6B63\u5219",allowClear:!0})}),(0,n.jsx)(s.Z.Item,{label:"\u542F\u7528 UDP",name:"enableUdp",children:(0,n.jsxs)(b.Z,{placeholder:"\u8BF7\u9009\u62E9\u662F\u5426\u542F\u7528 UDP",allowClear:!0,children:[(0,n.jsx)(b.Z.Option,{value:"true",children:"\u5F00\u542F"}),(0,n.jsx)(b.Z.Option,{value:"false",children:"\u5173\u95ED"})]})})]})),(0,n.jsx)(w.Z,{children:(0,n.jsx)(_.Z,{})}),(0,n.jsxs)(s.Z,p()(p()({},I),{},{form:d,children:[(0,n.jsx)(s.Z.Item,{label:"\u8BA2\u9605\u94FE\u63A5",name:"subscriptionUrl",children:(0,n.jsx)(j.Z,{onChange:S})}),(0,n.jsx)(s.Z.Item,{label:"\u8BA2\u9605\u77ED\u94FE",name:"shortSubscriptionUrl",children:(0,n.jsx)(j.Z,{})})]})),(0,n.jsx)(s.Z,p()(p()({},ee),{},{children:(0,n.jsx)(s.Z.Item,{children:(0,n.jsxs)("div",{className:y.tailButtonContainer,children:[(0,n.jsx)(T.Z,{className:y.tailButton,type:"primary",onClick:f,children:"\u751F\u6210\u94FE\u63A5"}),(0,n.jsx)(T.Z,{className:y.tailButton,type:"primary",onClick:ne,children:"\u751F\u6210\u77ED\u94FE"})]})})}))]}))},ae=ue,te=function(){return(0,n.jsx)(P._z,{children:(0,n.jsx)(ae,{})})},le=te}}]);
