"use strict";(self.webpackChunkant_design_pro=self.webpackChunkant_design_pro||[]).push([[271],{37531:function(se,B,t){t.r(B),t.d(B,{default:function(){return ue}});var D=t(70004),P=t(30279),p=t.n(P),k=t(46686),U=t.n(k),F=t(81463),V=t(38142),s=t(88106),$=t(37300),j=t(82711),E=t(57150),N=t(57836),L=t(28047),f=t(59496),G=t(35290),C=t.n(G),H=t(411),T=t.n(H),Z={clash:"Clash",clashr:"ClashR",quan:"Quantumult",quanx:"QuantumultX",loon:"Loon",ss:"SS (SIP002)",sssub:"SS Android",ssd:"SSD",ssr:"SSR",surfboard:"Surfboard","surge&ver=2":"Surge2","surge&ver=3":"Surge3","surge&ver=4":"Surge4",v2ray:"V2Ray"},A=function(){var r=location.pathname;return r.endsWith("/")?r.substring(0,r.length-1):r},Q=function(){var i=T()(C()().mark(function r(){var n;return C()().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("".concat(A(),"/rule-list.json"));case 2:return n=e.sent,e.next=5,n.json();case 5:return e.abrupt("return",e.sent);case 6:case"end":return e.stop()}},r)}));return function(){return i.apply(this,arguments)}}(),X=function(){var i=T()(C()().mark(function r(){var n;return C()().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("".concat(A(),"/backend-list.json"));case 2:return n=e.sent,e.next=5,n.json();case 5:return e.abrupt("return",e.sent);case 6:case"end":return e.stop()}},r)}));return function(){return i.apply(this,arguments)}}(),w=function(){var r=(0,f.useState)([]),n=U()(r,2),u=n[0],e=n[1];return(0,f.useEffect)(function(){var l=!1,o=[{value:window.location.origin+"/sub"}];return e(o),X().then(function(c){l||e(o.concat(c))}),function(){l=!0}},[]),u},z=w,M=function(){var r=(0,f.useState)([]),n=U()(r,2),u=n[0],e=n[1];return(0,f.useEffect)(function(){var l=!1;return Q().then(function(o){l||e(o)}),function(){l=!0}},[]),u},W=M,J=function(r){var n=r.get("target");if(!n)return null;if(!Z.hasOwnProperty(n)){var u=r.get("ver");if(!u||(n="".concat(n,"&ver=").concat(u),!Z.hasOwnProperty(n)))return null}return n},K=function(r){var n=r.backendUrl,u=r.targetType,e=r.sourceUrls,l=r.ruleUrl,o=r.filename,c=r.enableUdp,d=encodeURIComponent(e.split(/[\n|]/).map(function(b){return b.trim()}).filter(function(b){return b}).join("|")),v=encodeURIComponent(l),m="".concat(n,"?target=").concat(u,"&url=").concat(d,"&config=").concat(v);return o&&(m+="&filename=".concat(o)),c&&(m+="&udp=".concat(c)),m},Y=function(r){var n,u=new URL(r),e=u.searchParams,l={backendUrl:"".concat(u.origin).concat(u.pathname)},o=J(e);o&&(l.targetType=o);var c=(n=e.get("url"))===null||n===void 0?void 0:n.replaceAll("|",`
`);c&&(l.sourceUrls=c);var d=e.get("config");d&&(l.ruleUrl=d);var v=e.get("filename");v&&(l.filename=v);var m=e.get("udp");return(m==="true"||m==="false")&&(l.enableUdp=m),l},q=t(60042),y={tailButtonContainer:"tailButtonContainer___ZcOHp",tailButton:"tailButton___XHdRn"},a=t(4637),R={labelCol:{xs:{span:5},sm:{span:5},md:{span:4}},wrapperCol:{xs:{span:17},sm:{span:17},md:{span:18}}},_={wrapperCol:{span:24}},I=function(r,n){return n?n.label?n.label.toUpperCase().includes(r.toUpperCase()):n.value.includes(r):!1},ee=function(r,n){var u=U()(r,2),e=u[0],l=u[1];return(0,a.jsx)(F.Z.Option,{value:e,children:l},n)},re=function(){V.ZP.warning("\u656C\u8BF7\u671F\u5F85")},ne=function(r){console.debug("Subconverter render");var n=s.Z.useForm(),u=U()(n,1),e=u[0],l=s.Z.useForm(),o=U()(l,1),c=o[0],d=z(),v=W();(0,f.useEffect)(function(){d[0]&&!e.getFieldValue("backendUrl")&&e.setFieldsValue({backendUrl:d[0].value})},[e,d]),(0,f.useEffect)(function(){v[0]&&!e.getFieldValue("ruleUrl")&&e.setFieldsValue({ruleUrl:v[0].value})},[e,v]);var m=(0,f.useMemo)(function(){var h,g,S={targetType:"clash"},x=(h=d[0])===null||h===void 0?void 0:h.value;x&&(S.backendUrl=x);var O=(g=v[0])===null||g===void 0?void 0:g.value;return O&&(S.ruleUrl=O),S},[d,v]),b=(0,f.useCallback)(function(){e.validateFields().then(function(h){var g=K(h);c.setFieldsValue({subscriptionUrl:g})}).catch(function(){return console.error("\u8BA2\u9605\u94FE\u63A5\u751F\u6210\u9519\u8BEF\uFF01")})},[e,c]),le=(0,f.useCallback)(function(h){var g=h.target.value;try{var S=Y(g);e.setFieldsValue(S)}catch{console.error("\u9519\u8BEF\u7684\u8BA2\u9605\u94FE\u63A5\uFF01")}},[e]);return(0,a.jsxs)($.Z,p()(p()({},r),{},{title:"Subscription Converter",children:[(0,a.jsxs)(s.Z,p()(p()({},R),{},{form:e,initialValues:m,children:[(0,a.jsx)(s.Z.Item,{label:"\u8BA2\u9605\u94FE\u63A5",name:"sourceUrls",rules:[{required:!0,message:"\u8BA2\u9605\u94FE\u63A5\u4E0D\u53EF\u4E3A\u7A7A"}],children:(0,a.jsx)(j.Z.TextArea,{placeholder:"\u8BF7\u8F93\u5165\u8BA2\u9605\u94FE\u63A5\u5730\u5740",rows:3,allowClear:!0})}),(0,a.jsx)(s.Z.Item,{label:"\u76EE\u6807\u7C7B\u578B",name:"targetType",rules:[{required:!0,message:"\u76EE\u6807\u7C7B\u578B\u4E0D\u53EF\u4E3A\u7A7A"}],children:(0,a.jsx)(F.Z,{children:Object.entries(Z).map(ee)})}),(0,a.jsx)(s.Z.Item,{label:"\u540E\u7AEF\u5730\u5740",name:"backendUrl",rules:[{required:!0,message:"\u540E\u7AEF\u5730\u5740\u4E0D\u53EF\u4E3A\u7A7A"}],children:(0,a.jsx)(E.Z,{placeholder:"\u8BF7\u8F93\u5165\u540E\u7AEF\u670D\u52A1\u5668\u5730\u5740",options:d,allowClear:!0,filterOption:I})}),(0,a.jsx)(s.Z.Item,{label:"\u89C4\u5219\u5730\u5740",name:"ruleUrl",rules:[{required:!0,message:"\u89C4\u5219\u5730\u5740\u4E0D\u53EF\u4E3A\u7A7A"}],children:(0,a.jsx)(E.Z,{placeholder:"\u8BF7\u8F93\u5165\u8FDC\u7A0B\u89C4\u5219\u5730\u5740",options:v,allowClear:!0,filterOption:I})}),(0,a.jsx)(s.Z.Item,{label:"\u6587\u4EF6\u540D\u79F0",name:"filename",children:(0,a.jsx)(j.Z,{placeholder:"\u8BF7\u8F93\u5165\u6587\u4EF6\u540D\u79F0",allowClear:!0})}),(0,a.jsx)(s.Z.Item,{label:"\u542F\u7528 UDP",name:"enableUdp",children:(0,a.jsxs)(F.Z,{placeholder:"\u8BF7\u9009\u62E9\u662F\u5426\u542F\u7528 UDP",allowClear:!0,children:[(0,a.jsx)(F.Z.Option,{value:"true",children:"\u5F00\u542F"}),(0,a.jsx)(F.Z.Option,{value:"false",children:"\u5173\u95ED"})]})})]})),(0,a.jsx)(N.Z,{children:(0,a.jsx)(q.Z,{})}),(0,a.jsxs)(s.Z,p()(p()({},R),{},{form:c,children:[(0,a.jsx)(s.Z.Item,{label:"\u8BA2\u9605\u94FE\u63A5",name:"subscriptionUrl",children:(0,a.jsx)(j.Z,{onChange:le})}),(0,a.jsx)(s.Z.Item,{label:"\u8BA2\u9605\u77ED\u94FE",name:"shortSubscriptionUrl",children:(0,a.jsx)(j.Z,{})})]})),(0,a.jsx)(s.Z,p()(p()({},_),{},{children:(0,a.jsx)(s.Z.Item,{children:(0,a.jsxs)("div",{className:y.tailButtonContainer,children:[(0,a.jsx)(L.Z,{className:y.tailButton,type:"primary",onClick:b,children:"\u751F\u6210\u94FE\u63A5"}),(0,a.jsx)(L.Z,{className:y.tailButton,type:"primary",onClick:re,children:"\u751F\u6210\u77ED\u94FE"})]})})}))]}))},ae=ne,te=function(){return(0,a.jsx)(D._z,{children:(0,a.jsx)(ae,{})})},ue=te}}]);
